<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Peminjaman Buku - Kepatuhan SKKNI</title>
    <style>
        :root {
            --primary: #2563eb;
            --success: #16a34a;
            --danger: #dc2626;
            --bg: #f8fafc;
            --card: #ffffff;
            --accent: #6366f1;
            --dark: #0f172a;
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            padding: 20px; 
            background: var(--bg); 
            color: #1e293b;
            line-height: 1.5;
        }

        .container { 
            max-width: 750px; 
            margin: auto; 
            background: var(--card); 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); 
        }

        .header {
            border-bottom: 2px solid #e2e8f0;
            margin-bottom: 25px;
            padding-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h2 { margin: 0; color: #0f172a; }
        h3 { margin-bottom: 15px; font-size: 1.1em; color: #334155; border-left: 4px solid var(--accent); padding-left: 10px; }
        p.subtitle { color: #64748b; font-size: 0.8em; margin-top: 5px; }

        /* J.620100.010.01: Form & Input */
        .form-tambah {
            background: #f1f5f9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 10px;
            align-items: end;
        }

        .input-group { display: flex; flex-direction: column; gap: 5px; }
        .input-group label { font-size: 0.8em; font-weight: 600; color: #475569; }
        input { 
            padding: 10px; 
            border: 1px solid #cbd5e1; 
            border-radius: 6px; 
            font-size: 0.9em;
        }

        .btn-add { 
            background: var(--accent); 
            color: white; 
            height: 40px;
            padding: 0 20px;
        }

        /* List Buku */
        .book-item { 
            padding: 15px; 
            border: 1px solid #e2e8f0;
            margin-bottom: 10px;
            border-radius: 8px;
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            background: white;
        }

        .book-info { flex-grow: 1; }
        .book-title { display: block; font-weight: 600; color: #1e293b; }
        .book-author { font-size: 0.85em; color: #64748b; }

        .status { 
            font-weight: 700; 
            padding: 4px 10px; 
            border-radius: 20px; 
            font-size: 0.75em; 
            text-transform: uppercase;
            margin-right: 10px;
            display: inline-block;
            min-width: 90px;
            text-align: center;
        }

        .available { background: #dcfce7; color: #166534; }
        .borrowed { background: #fee2e2; color: #991b1b; }

        .actions { display: flex; gap: 8px; }

        button { 
            cursor: pointer; 
            padding: 8px 16px; 
            border: none; 
            border-radius: 6px; 
            font-weight: 600;
            font-size: 0.85em;
            transition: all 0.2s;
        }

        button:hover:not(:disabled) { opacity: 0.8; transform: translateY(-1px); }
        
        .btn-borrow { background: var(--primary); color: white; }
        .btn-return { background: var(--success); color: white; }
        
        button:disabled { 
            background: #cbd5e1; 
            cursor: not-allowed; 
            opacity: 0.7;
        }

        /* J.620100.025.02: Debug View */
        #debug-container {
            margin-top: 20px;
            display: none;
            background: #27272a;
            color: #10b981;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.75em;
            white-space: pre-wrap;
            border-left: 5px solid var(--success);
        }

        /* Log Section */
        #log-container { margin-top: 30px; }
        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        #log { 
            padding: 15px; 
            background: var(--dark); 
            color: #38bdf8;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.85em; 
            height: 120px; 
            overflow-y: auto; 
            border-radius: 8px;
            line-height: 1.5;
        }

        .utility-btns { display: flex; gap: 5px; }
        .test-btn { background: #64748b; color: white; font-size: 0.7em; padding: 4px 8px; }
        .debug-btn { background: #f59e0b; color: white; font-size: 0.7em; padding: 4px 8px; }

        @media (max-width: 600px) {
            .form-tambah { grid-template-columns: 1fr; }
            .book-item { flex-direction: column; align-items: flex-start; gap: 10px; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div>
            <h2>Sistem Peminjaman Buku</h2>
            <p class="subtitle">Compliance: J.620100.010.01 & J.620100.025.02</p>
        </div>
        <div class="utility-btns">
            <button class="debug-btn" onclick="toggleDebug()">Toggle Debug</button>
            <button class="test-btn" onclick="jalankanUjiUnit()">Uji Sistem</button>
        </div>
    </div>

    <!-- J.620100.025.02: Monitor Data Real-time -->
    <div id="debug-container">// Data Structure Debug View (JSON)</div>

    <!-- Form Tambah Buku Baru (J.620100.010.01) -->
    <section>
        <h3>Tambah Koleksi Buku</h3>
        <div class="form-tambah">
            <div class="input-group">
                <label for="judul">Judul Buku</label>
                <input type="text" id="judul" placeholder="Contoh: Belajar JS">
            </div>
            <div class="input-group">
                <label for="penulis">Penulis</label>
                <input type="text" id="penulis" placeholder="Nama Penulis">
            </div>
            <button class="btn-add" onclick="tambahBukuBaru()">Tambah</button>
        </div>
    </section>

    <!-- Area Daftar Buku -->
    <section>
        <h3>Inventaris Koleksi</h3>
        <div id="book-list"></div>
    </section>
    
    <!-- Log Aktivitas (J.620100.023.02) -->
    <div id="log-container">
        <div class="log-header">
            <strong>Log Aktivitas Sistem</strong>
        </div>
        <div id="log">Sistem inisialisasi...<br></div>
    </div>
</div>

<script>
    /**
     * DOKUMENTASI STRUKTUR DATA (J.620100.004.02)
     */
    let inventarisBuku = [
        { id: 101, judul: "Clean Code", penulis: "Robert C. Martin", dipinjam: false },
        { id: 102, judul: "Javascript: The Good Parts", penulis: "Douglas Crockford", dipinjam: false }
    ];

    const kontainerBuku = document.getElementById('book-list');
    const areaLog = document.getElementById('log');
    const debugArea = document.getElementById('debug-container');

    /**
     * J.620100.025.02: Debugging & Monitoring
     * Fungsi untuk memperbarui tampilan data mentah guna membantu debugging.
     */
    function updateDebugView() {
        debugArea.textContent = "// DEBUG: Current Data State\n" + JSON.stringify(inventarisBuku, null, 2);
    }

    function toggleDebug() {
        debugArea.style.display = debugArea.style.display === 'block' ? 'none' : 'block';
        tambahLog(`[Debug] Tampilan data mentah ${debugArea.style.display === 'block' ? 'diaktifkan' : 'dimatikan'}`);
    }

    /**
     * J.620100.010.01: Menerapkan Perintah Eksekusi
     * Menambahkan data baru ke dalam array melalui antarmuka grafis.
     */
    function tambahBukuBaru() {
        const inputJudul = document.getElementById('judul');
        const inputPenulis = document.getElementById('penulis');

        // Validasi Eksekusi
        if (inputJudul.value.trim() === "" || inputPenulis.value.trim() === "") {
            tambahLog("[Peringatan] Input gagal: Judul/Penulis kosong", "danger");
            return;
        }

        const idBaru = inventarisBuku.length > 0 ? Math.max(...inventarisBuku.map(b => b.id)) + 1 : 101;
        
        const bukuBaru = {
            id: idBaru,
            judul: inputJudul.value,
            penulis: inputPenulis.value,
            dipinjam: false
        };

        inventarisBuku.push(bukuBaru);
        tambahLog(`[Sistem] Eksekusi Tambah: "${bukuBaru.judul}" berhasil.`);
        
        inputJudul.value = "";
        inputPenulis.value = "";
        
        refreshUI();
    }

    /**
     * J.620100.017.02: Pemrograman Terstruktur
     */
    function refreshUI() {
        tampilkanBuku();
        updateDebugView();
    }

    function tampilkanBuku() {
        kontainerBuku.innerHTML = '';
        inventarisBuku.forEach(buku => {
            const elemen = document.createElement('div');
            elemen.className = 'book-item';
            elemen.innerHTML = `
                <div class="book-info">
                    <span class="book-title">${buku.judul}</span>
                    <span class="book-author">Oleh: ${buku.penulis}</span>
                </div>
                <div class="actions">
                    <span class="status ${buku.dipinjam ? 'borrowed' : 'available'}">
                        ${buku.dipinjam ? 'Dipinjam' : 'Tersedia'}
                    </span>
                    <button class="btn-borrow" onclick="pinjamBuku(${buku.id})" ${buku.dipinjam ? 'disabled' : ''}>Pinjam</button>
                    <button class="btn-return" onclick="kembalikanBuku(${buku.id})" ${!buku.dipinjam ? 'disabled' : ''}>Kembali</button>
                </div>
            `;
            kontainerBuku.appendChild(elemen);
        });
    }

    function pinjamBuku(id) {
        const buku = inventarisBuku.find(b => b.id === id);
        if (buku) {
            buku.dipinjam = true;
            tambahLog(`[Eksekusi] Peminjaman ID ${id} (${buku.judul}) sukses.`);
            refreshUI();
        }
    }

    function kembalikanBuku(id) {
        const buku = inventarisBuku.find(b => b.id === id);
        if (buku) {
            buku.dipinjam = false;
            tambahLog(`[Eksekusi] Pengembalian ID ${id} sukses.`);
            refreshUI();
        }
    }

    function tambahLog(pesan, tipe = "info") {
        const waktu = new Date().toLocaleTimeString();
        const warna = tipe === "danger" ? "#f87171" : "#38bdf8";
        areaLog.innerHTML += `<span style="color: ${warna}">[${waktu}] ${pesan}</span><br>`;
        areaLog.scrollTop = areaLog.scrollHeight;
    }

    /**
     * J.620100.033.02: Pengujian Unit
     */
    function jalankanUjiUnit() {
        tambahLog("--- MEMULAI PENGUJIAN OTOMATIS ---");
        
        // Uji Logic Debugging & Data
        const testId = 101;
        pinjamBuku(testId);
        const dataMatch = inventarisBuku.find(b => b.id === testId).dipinjam === true;
        
        if (dataMatch) {
            tambahLog("UNIT_TEST: Sinkronisasi Data & UI: BERHASIL");
        } else {
            tambahLog("UNIT_TEST: Sinkronisasi Data & UI: GAGAL", "danger");
        }

        kembalikanBuku(testId);
        tambahLog("--- PENGUJIAN SELESAI ---");
    }

    // Inisialisasi Awal
    refreshUI();
</script>

</body>
</html>
